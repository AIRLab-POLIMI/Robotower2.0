<?xml version="1.0" ?>
<launch>
    <!-- params -->
    <param name="forest_file" value="$(find player_tracker)/config/trained_leg_detector_res=0.33.yaml" />
    <param name="scan_topic" value="/scan" />
    <param name="fixed_frame" value="/map"/>
    <param name="scan_frequency" value="10"/>
    <param name="leg_dist_model" value="$(find player_tracker)/model/leg_distance-gmm.pkl"/>
    <param name="perception_grid_topic" value="local_map" />

    <!-- laser to grid parameteres 
    <rosparam file="$(find player_tracker)/config/laser_to_grid.yaml" command="load" ns="/laser_to_grid_node/costmap" />-->

    <!-- run detect_leg_clusters -->
    <node pkg="player_tracker" type="detect_leg_clusters" name="detect_leg_clusters" output="screen"/>

    <!-- run joint_player_tracker -->
    <node pkg="player_tracker" type="joint_leg_tracker.py" name="joint_leg_tracker" output="screen" />

    <!-- run joint_player_tracker -->
    <node pkg="player_tracker" type="detector.py" name="detector" output="screen"/>

    <!-- run local_occupancy_grid_mapping -->
    <node pkg="player_tracker" type="local_occupancy_grid_mapping" name="local_occupancy_grid_mapping" output="screen"/>


    <!-- Laser scan to occupancy grid (to fix)-->
    <!-- <node pkg="costmap_2d" type="costmap_2d_node" name="laser_to_grid_node" output="screen" /> -->

    <node pkg="player_tracker" type="perception_grid_node.py" name="perception_grid_node" output="screen" />


    <node type="point_cloud_assembler" pkg="laser_assembler" name="cloud_assembler">
        <remap from="cloud" to="laser_cloud"/>
        <param name="max_clouds" type="int" value="400" />
        <param name="fixed_frame" type="string" value="odom" />
    </node>

    <node pkg="player_tracker" type="motion_detector" name="motion_detector" output="screen"/>

    <!-- run rviz -->
    <node pkg="rviz" type="rviz" name="rviz" />

    <!-- play rosbag -->
    <node pkg="rosbag" type="play" name="player" output="screen" required="true"
        args="--delay=4 --clock --rate=1.0 -s 0 $(find player_tracker)/rosbags/experiments/_2017-12-12-18-45-06.bag"/>

    <param name="use_sim_time" value="true" />

</launch>
